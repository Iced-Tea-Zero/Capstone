<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TOOL TOOLS</title>
    <link href="../data/style/list.css" rel="stylesheet" />
    <script src="../js/fruits.js"></script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.js"
      integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
      crossorigin="anonymous"
    ></script>
    <script src="../js/list.js"></script>
  </head>
  <body>
    <div class="header">
      <div class="header-item">
        <a href="../html/select3.html">
          <img src="../data/img/logo.png" class="logo" />
        </a>
      </div>

      <div class="detail-search">
        <div id="results"></div>
        <form>
          <input
            type="text"
            class="search"
            id="searchInput"
            placeholder="     ì–´ë–¤ ì›¹ ì‚¬ì´íŠ¸ë¥¼ ì°¾ê³  ê³„ì‹ ê°€ìš”?ğŸ§"
          />
          <input
            type="submit"
            name="submit"
            value="ê²€ìƒ‰"
            style="width: 50px; height: 35px"
          />
        </form>
      </div>
      <script>
        function searchFruits() {
          const searchInput = document.getElementById("searchInput");
          const searchTerm = searchInput.value.toLowerCase();
          const resultsContainer = document.getElementById("results");
          resultsContainer.innerHTML = "";

          const filteredFruits = fruits.filter((fruit) => {
            return fruit.title.toLowerCase().includes(searchTerm);
          });

          if (filteredFruits.length > 0) {
            filteredFruits.forEach((fruit) => {
              const div = document.createElement("div");
              div.style.margin = "auto";
              // div.style.backgroundColor = "skyblue";
              div.style.fontSize = "15px";
              div.style.width = "500px";
              div.textContent = fruit.title;
              resultsContainer.appendChild(div);
              resultsContainer.classList.add("show"); // Show the results container
            });
          } else {
            const p = document.createElement("p");
            p.textContent = "ë“±ë¡ëœ ì‚¬ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.";
            resultsContainer.appendChild(p);
            resultsContainer.classList.remove("show"); // Hide the results container
          }
        }

        const searchInput = document.getElementById("searchInput");
        searchInput.addEventListener("input", searchFruits);

        function submitSearch() {
          const searchInput = document.getElementById("searchInput");
          const searchTerm = searchInput.value.trim().toLowerCase();

          if (searchTerm !== "") {
            const matchingFruits = fruits.filter((fruit) => {
              return fruit.title.toLowerCase().includes(searchTerm);
            });

            if (matchingFruits.length > 0) {
              const fruitIndex = fruits.indexOf(matchingFruits[0]);
              const url =
                "http://127.0.0.1:5501/Capstone/front/html/detail" +
                fruitIndex +
                ".html";
              window.location.href = url;
            } else {
              console.log("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
            }
          }
        }

        const searchForm = document.querySelector(".detail-search form");
        searchForm.addEventListener("submit", function (e) {
          e.preventDefault();
          submitSearch();
        });
      </script>
    </div>

    <div class="login">
      <a
        href="../html/login.html"
        style="color: aliceblue; text-decoration-line: none"
      >
        ë¡œê·¸ì¸ <br
      /></a>


    </div>
<body>

	<h2></h2>

	<table>
		<tr>
			<th>Title</th>
			<th>Link</th>
			<th>Hashtag</th>
		</tr>

		<!-- JSON ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ HTMLë¡œ ë³€í™˜ -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
		<script>
			$(document).ready(function() {
			  var filter = localStorage.getItem("filter"); // ê²€ìƒ‰ì–´ë¥¼ localStorageì—ì„œ ê°€ì ¸ì˜´
			  var selectedTags = filter.split(", "); // ì„ íƒí•œ í•´ì‹œíƒœê·¸ë¥¼ ì‰¼í‘œì™€ ê³µë°±ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ë°°ì—´ë¡œ ë§Œë“¦

			  $.getJSON("../data/sitelink.json", function(data) {
				$.each(data, function(key, value) {
				  var hashtags = value.hashtag.split(", "); // í•´ì‹œíƒœê·¸ë¥¼ ì‰¼í‘œì™€ ê³µë°±ìœ¼ë¡œ ë¶„ë¦¬í•˜ì—¬ ë°°ì—´ë¡œ ë§Œë“¦
				  var isMatched = selectedTags.every(function(tag) {
					return hashtags.includes(tag); // ì„ íƒí•œ ëª¨ë“  í•´ì‹œíƒœê·¸ê°€ í•­ëª©ì˜ í•´ì‹œíƒœê·¸ì— í¬í•¨ë˜ì–´ì•¼ í•¨
				  });

				  if (isMatched) {
					var titleLink = "<a href='detail" + key + ".html'>" + value.title + "</a>";
					$("table").append("<tr><td>" + titleLink + "</td><td><a href='" + value.link + "'>" + value.link + "</a></td><td>" + value.hashtag + "</td></tr>");
				  }
				});

				// ì„ íƒí•œ ì œëª© í´ë¦­ ì‹œ í•´ë‹¹ ë§í¬ë¡œ ì´ë™
				$("table").on("click", "a", function(e) {
				  e.preventDefault(); // ê¸°ë³¸ ë™ì‘ ì¤‘ë‹¨ (í˜ì´ì§€ ì´ë™ ë°©ì§€)
				  var link = $(this).attr("href");
				  window.location.href = link; // í´ë¦­í•œ ë§í¬ë¡œ í˜ì´ì§€ ì´ë™
				});
			  });
			});
		  </script>


	</table>

</body>
</html>
